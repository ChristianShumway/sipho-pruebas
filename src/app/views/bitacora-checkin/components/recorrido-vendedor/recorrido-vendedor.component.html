<mat-card>
  <form [formGroup]="bitacoraForm" (submit)="getTravels()">
    <div fxFlex="100" fxFlex.gt-md="100" fxFlex.gt-sm="100" class="container-bitacora">

      <div class="wrap-form">
        <div class="pb-1">
          <mat-form-field class="full-width">
            <input matInput [matDatepicker]="fechaInicio" formControlName="date" name="date" placeholder="Fecha Captura" (dateChange)="onFechaInicio($event)">
            <mat-datepicker-toggle matSuffix [for]="fechaInicio"></mat-datepicker-toggle>
            <mat-datepicker #fechaInicio (selectedChange)="onFechaInicio($event)"></mat-datepicker>
          </mat-form-field>
          <div class="validaciones">
            <small *ngIf="bitacoraForm.controls['date'].hasError('required') && bitacoraForm.controls['date'].touched" class="form-error-msg">
              Fecha de captura es un campo requerido
            </small>
          </div>
        </div>
        <div class="pb-1">
          <mat-form-field class="full-width">
            <mat-label>Vehiculo</mat-label>
            <mat-select formControlName="vehicles">
              <mat-option *ngFor="let vehiculo of vehiculos" [value]="vehiculo">
                {{vehiculo.linea}} {{vehiculo.marca}} {{vehiculo.modelo}}
              </mat-option>
            </mat-select>
          </mat-form-field>
          <div class="validaciones">
            <small *ngIf="bitacoraForm.controls['vehicles'].hasError('required') && bitacoraForm.controls['vehicles'].touched" class="form-error-msg">
              Veh√≠culo es un campo requerido
            </small>
          </div>
        </div>
      </div>

      <div class="wrap-button">
        <button mat-raised-button color="primary" [disabled]="bitacoraForm.invalid" type="submit" class="btn-accept">Buscar</button>
        <!-- <button mat-raised-button [routerLink]="'/ejecucion-proyecto/proyectos/reporte-conceptos-ejecutados'">Cancelar</button> -->
      </div>

    </div>
  </form>
</mat-card>

<mat-card class="col-md-10 wrap-mapa">
  <!-- <agm-map [latitude]="latitude" [longitude]="longitude" [fullscreenControl]='true' [mapTypeControl]='true' [fitBounds]="true"> -->
  <agm-map #gm [latitude]="latitude" [longitude]="longitude" [zoom]="zoom" [scrollwheel]="null" [gestureHandling]="'cooperative'"
    [mapTypeControl]='true'>
    <agm-marker *ngFor="let coordinate of showMarks; let i=index" [latitude]="coordinate.location.lat" [longitude]="coordinate.location.lng"
      [iconUrl]="icon" (markerClick)="gm.lastOpen?.close(); gm.lastOpen = infoWindow; markerClicked(coordinate);">
      <agm-info-window #infoWindow>{{previous | json}}</agm-info-window>
    </agm-marker>
    <agm-polyline *ngFor="let dataCoordinates of multipleDataCoordinates" [visible]="true" [strokeWeight]="3" [strokeColor]="dataCoordinates.color">
      <agm-polyline-point *ngFor="let coordinate of dataCoordinates.path; let i=index" [latitude]="coordinate.location.lat" [longitude]="coordinate.location.lng"></agm-polyline-point>
    </agm-polyline>
  </agm-map>
</mat-card>

<mat-card class="wrap-table-info" *ngIf="dataTable.length" >
  <div class="table-container">
    <table #table mat-table [dataSource]="dataSource" class="mat-elevation-z8"  matSort>
  
      <ng-container matColumnDef="empleado">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Empleado </th>
        <td mat-cell *matCellDef="let recorrido"> {{recorrido.empleado}} </td>
      </ng-container>
  
      <ng-container matColumnDef="cliente">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Cliente </th>
        <td mat-cell *matCellDef="let recorrido"> {{recorrido.cliente}} </td>
      </ng-container>
  
      <ng-container matColumnDef="fecha">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Fecha </th>
        <td mat-cell *matCellDef="let recorrido"> {{recorrido.fecha | date}} </td>
      </ng-container>
  
      <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>
  </div>
  <mat-paginator [length]="dataTable.length" [pageSize]="10"></mat-paginator>
</mat-card>